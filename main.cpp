/*
 * main.cpp
 *
 *  Created on: Dec 21, 2012
 *      Author: alex
 */

#include <stdio.h>
#include <iostream>
//#include "Eigen/Core"
//#include "Eigen/Dense"
//#include <gmpxx.h>
#include <NTL/mat_ZZ.h>
#include <NTL/ZZ.h>
#include <sys/time.h>

using namespace std;
//using namespace Eigen;
using namespace NTL;

//typedef Matrix<mpz_class, Dynamic, Dynamic> Matrix_mpz;

#define MATRIX_SIZE 64

void startTimer(struct timeval & tv);
void stopTimerAndPrintMilliSeconds(struct timeval & tv, const char * str, int round);
//void initMatrix(Matrix_mpz * m);
void initMatrix(mat_ZZ & m);

int main(int argc, char ** argv) {
	struct timeval tv;


	mat_ZZ m(INIT_SIZE, MATRIX_SIZE, MATRIX_SIZE);
	mat_ZZ tmp(INIT_SIZE, MATRIX_SIZE, MATRIX_SIZE);
	initMatrix(m);

	/*
	Matrix_mpz m(MATRIX_SIZE,MATRIX_SIZE);
	Matrix_mpz m2;

	initMatrix(&m);
	*/
	//measure addition:
	startTimer(tv);
	for (int i = 0; i < 100; ++i) {
		add(tmp, m, m);
	}
	stopTimerAndPrintMilliSeconds(tv, "Addition Time (ms): ", 100);

	//measure multiplication:
	/*
	startTimer(tv);
	mul(tmp, m, m);
	stopTimerAndPrintMilliSeconds(tv, "Multiplication Time (ms): ");*/

}

void startTimer(struct timeval & tv) {
	gettimeofday(&tv, NULL);
}

void stopTimerAndPrintMilliSeconds(struct timeval & tv, const char * str, int rounds) {
	struct timeval tv2;
	int diff;
	gettimeofday(&tv2, NULL);
	diff = (tv2.tv_sec - tv.tv_sec)*1000000 + tv2.tv_usec - tv.tv_usec;
	cout << str << diff/1000/rounds << endl << endl;
}
/*
void initMatrix(Matrix_mpz * m) {
	for (int i = 0; i < m->rows(); i++) {
		for (int j = 0; j < m->cols(); j++) {
			mpz_class n;
			//n.set_str("42342342367657094385702394790342342429809089802348923824875093475908347509384", 10);
			n.set_str("a646aeffe54f64f6ea46a5e4f6ae54fae5640890980131fae3fea3f21eae1cc57576534980cceef", 16);
			(*m)(i,j) = n;
		}
	}
}
*/

void initMatrix(mat_ZZ & m) {
	ZZ n64 = to_ZZ("9999999999999999995");
	ZZ n128 = to_ZZ("99993749237498237498237493299999999995");
	ZZ n256 = to_ZZ("99993749237498237498237493299999937129873912873981273129842343242399999799995");
	ZZ n512 = to_ZZ("9999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995");
	ZZ n1024 = to_ZZ("99993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995");
	ZZ n2048 = to_ZZ("9999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995");
	ZZ n4096 = to_ZZ("99993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995");
	ZZ n8192 = to_ZZ("9999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995999937492374982374982374932999999371298739128739812731298423432423999997999959999374923749823749823749329999993712987391287398127312984234324239999979999599993749237498237498237493299999937129873912873981273129842343242399999799995");

	ZZ & n = n64;
	for (int i = 1; i <= m.NumRows(); i++) {
		for (int j = 1; j <= m.NumCols(); j++) {
			m(i,j) = n;
		}
	}
}
